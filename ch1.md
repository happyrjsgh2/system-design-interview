# ch1. 사용자 수에 따른 규모 확장성

<br />

## 데이터베이스

<br />

### DB 종류

- 관계형 데이터베이스(RDBMS)
  - 열과 행의 테이블 구조인 데이터베이스, 테이블끼리의 관계에 따라 join하여 합칠 수 있다.
  - 대부분의 시스템에서 사용되는 일반적인 DB이며 오랜 역사에 따른 생턔계와 안정성이 강점.
- 비관계형 데이터베이스(NoSQL)
  - 일반적으로 join 연산은 지원 안함.
  - 구축하려는 시스템의 특성에 따라 NoSQL이 바람직한 선택일 수도 있음
    - 아주 낮은 응답 지연시간(latency) 필요
    - 다루는 데이터가 비정형이라 관계형 데이터가 아님
    - 데이터를 직렬화 하거나 역직렬화 할 수 있기만 하면 됨.
    - 아주 많은 양의 데이터를 저장할 필요가 있음.

### DB 다중화

- DB끼리 master -> slave 관계를 맺어 write는 master에서, read는 slave에서만 하도록 설정
- 병렬로 처리되는 쿼리 수가 늘어나므로 성능 향상
- 데이터베이스 중 일부가 다운되도 분산되어 있기때문에 안정성 향상

<br />

## 규모 확장

- 수직적 규모 확장(scale up) : 서버에 고사양 자원(더 좋은 CPU, 더 많은 RAM)등을 추가하는 행위
  - 서버로 유입되는 트래픽의 양이 적을때 좋은 선택, 가장 큰 단점은 단순함이다.
  - 규모 확장에 한계가 있다.
  - 장애에 대한 자동복구 방안, 다중화 방안을 제시하지 않는다. scale up 한 서버의 장애가 발생하면 서비스는 죽는다.
- 수평적 규모 확장(scale out): 더 많은 서버를 추가하여 성능을 개선하는 행위
  - 대규모 서비스를 운영하는데는 수평적 규모 확장법이 적절하다.

<br />

## 로드밸런서

- 로드밸런서는 부하 분산 집합에 속한 웹 서버들에게 트래픽 부하를 고르게 분산하는 역할
- 보안을 위해 사설 IP 주소를 사용
- 여러대의 서버로 로드밸런서를 통해 트래픽을 분산하게 되면 서버1이 다운되도 로드밸런서가 다른 서버로 트래픽을 보내기 때문에
  서비스가 죽지않고 지속된다.

> 계층에 따른 로드밸런서가 있는걸로 아는데, 가령 웹서버단(apache, nginx)에서 로드밸런싱 하는 경우는 어떤건지?

<br />

## 캐시

- 자주 참조되는 데이터를 메모리 안에 두고 빨리 처리될 수 있도록 하는 저장소
- 대부분의 애플리케이션의 병목은 DB단에서 일어나기 떄문에 캐시서버를 둠으로써 문제 완화 가능
- 캐시할 데이터의 특성에 따라 다양한 캐시전략을 고려하여 선택해야 함

<br />

## CDN

- 정적 콘텐츠 서빙에 쓰이는 지리적으로 분산된 서버의 네트워크
- 이미지, 비디오, JS파일 등은 CDN을 통한 캐싱으로 성능 향상

> CDN은 외부 서비스고 이런 정적 컨텐츠를 외부 서비스에 의존하게 되면 다운 시 대처는?

<br />

## 무상태(stateless) 웹 계층

- 웹 계층을 수평적으로 확장하게 되면 사용자 정보와 같은 상태를 제거해야 함.
- 인증을 위한 상태를 특정 서버x만 가지고 있다면
  클라이언트의 모든 요청은 항상 x서버로만 전송되어야 하는 문제가 발생
- 같은 클라이언트의 요청은 같은서버로만 전송되어야 하는 기능을 제공하기 위해 _스티키 세션_ 기능을 로드밸런스단에서 제공하지만 이는 부담을 준다.
- 상태를 웹서버가 아닌 DB에 저장한다.

> 인증서버의 부하가 걸리면 어떻게 함?

<br />

## 데이터 센터

- 사용자의 위치에 따라 가장 가까운 데이터 센터로 라우팅 해주는것을 지리적 라우팅, geoDNS라 한다.

<br />

## 메시지 큐

- 메세지의 무손실을 보장하는 비동기 통신 컴포넌트
- 생산자가 메시지를 만들어 큐에 발행하면 구독자가 메시지를 받아서 동작을 수행한다.
- 서버간 결합이 느슨해지기 때문에 안정적인 애플리케이션 구축 가능

> 메시지큐가 뭐지?

<br />

## 로그, 매트릭

- 웹서비스의 복잡도와 규모가 커짐에 따라 안정적인 운영을 위해 로그와 매트릭같은 도구들이 필요

<br />
<br />

> Q. 유명인사(celebrity) 문제가 매우 흥미로운 예제인데, 어떤식으로 해결하는게 좋을까요? (p.28)
> Q. 데이터 샤딩 방식의 대표적인 정책?

- 내가 원하는 데이터가 어느 샤드에 있는지 어떻게 알지?
  - p.28 설명보면 샤딩키를 통해 올바른 곳으로 질의한다는데 애플리케이션단에서 db에 쿼리 날릴 시 포함하는건가?

##
